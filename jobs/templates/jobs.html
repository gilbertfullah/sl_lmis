{% extends 'main.html' %}
{% load widget_tweaks %}
{% load crispy_forms_tags %}
{% load static %}

{% block content %}

<link rel="stylesheet" href="{% static 'styles/styles.css' %}">
<link rel="stylesheet" href="{% static 'styles/css/style.css' %}">

<section class="pt-5 pt-md-10 pt-lg-28 pb-5 pb-md-10 pb-lg-28" style="background-image: url('{% static 'images/background.png' %}'); background-position: center; background-size: cover;">
  <div class="container mx-auto">
    <div class="row">
      <div class="col-12">
        <div class="text-center text-white">
          <h3 class="mb-4 fs-2 text-white fw-bold">Browse All Jobs</h3>
          <div class="page-next">
            <nav class="inline-block" aria-label="breadcrumb text-center">
              <ol class="flex flex-wrap justify-center text-sm font-medium uppercase list-none p-0 m-0">
                <li class="list-inline-item"><a href="{% url 'home' %}" class="text-white">Home</a></li>
                <li class="list-inline-item active" aria-current="page"><i class="bi bi-chevron-right align-middle px-2.5 text-white pr-2"></i> All Jobs</li>
              </ol>
            </nav>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<div style="background-color:white; padding-bottom:60px;">

  <div class="container mt-5 mb-5">
    <div class="row">
      <div class="col-md-12">
          <!-- form -->
          <form action="{% url 'job_search_list' %}" method="get" class="row g-3 bg-light p-4 rounded">
            <div class="col-md-3">
                <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-card-text"></i></span>
                    <input type="text" class="form-control" id="jobTitle" name="jobTitle" placeholder="Enter job title" style="height:55px;">
                </div>
            </div>
            <div class="col-md-3">
                <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-geo-alt"></i></span>
                    <select class="form-select" id="location" name="location" style="height:55px;">
                        <option value="" selected>Any Location</option>
                        <option value="newyork">New York</option>
                        <option value="losangeles">Los Angeles</option>
                        <!-- Add more location options here -->
                    </select>
                </div>
            </div>
            <div class="col-md-3">
                <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-briefcase"></i></span>
                    <select class="form-select" id="jobSector" name="jobSector" style="height:55px;">
                        <option value="" selected>Any Sector</option>
                        {% for sector in sectors %}
                            <option value="{{ sector }}">{{ sector }}</option>
                        {% endfor %}
                        
                        <!-- Add more job sector options here -->
                    </select>
                </div>
            </div>
            <div class="col-md-3 text-center" style="margin-left: -40px;">
                <button type="submit" class="btn btn-primary" style="background-color: #29569F;">Find Job</button>
            </div>
        </form>
        
        
      </div>
    </div>
  </div>



  <div class="container-fluid">
    {% if jobs %}
    <h3 class="text-center my-4 font-weight-bold" style="position:relative; left: -210px; font-weight: bold">{{jobs_count}} Jobs found</h3>
    {% else %}
    <h3 class="text-center my-4 font-weight-bold" style="position:relative; left: -210px; font-weight: bold">No Jobs found</h3>
    {% endif %}
    <div class="row">
      <div class="col-lg-3 col-xl-3 col-md-3 col-sm-12">
        <h4>Locations</h4>
          <ul class="list-group">
            {% for location in locations %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <a href="?location={{ location.id }}" class="text-black">{{ location.name }}</a>
                <span class="badge bg-primary rounded-pill">
                    {% for loc_count in locations_with_counts %}
                        {% if loc_count.id == location.id %}
                            {{ loc_count.job_count }}
                        {% endif %}
                    {% endfor %}
                </span>
            </li>
            {% endfor %}
          </ul>
      </div>
      <div class="col-lg-9 col-xl-9 col-md-9 col-sm-12">

          {% if jobs %}
                  {% for job in jobs %}
                  <div class="job-item p-4 mb-4">
                      <div class="row g-4">
                          <div class="col-sm-12 col-lg-8 col-md-8 d-flex align-items-center mb-5"> 
                              <a href="{% url 'job_detail' job.id %}"><img class="flex-shrink-0 img-fluid border rounded" src="{{ job.image.url}}" alt="" style="width: 80px; height: 80px;"></a>
                              <div class="text-start ps-4">
                                  <h5 class="mb-3"><a href="{% url 'job_detail' job.id %}" style="color:black; font-weight:700">{{job.title}}</a></h5>
                                  <span class="text-truncate me-0" style="padding-right: 25px; font-size: 18px;"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#29569F" class="bi bi-building" viewBox="0 0 16 16">
                                      <path d="M4 2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1Zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1Zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1ZM4 5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1ZM7.5 5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1Zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1ZM4.5 8a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1Zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1Zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1Z"/>
                                      <path d="M2 1a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V1Zm11 0H3v14h3v-2.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5V15h3V1Z"/>
                                    </svg> {{job.employer}}</span>
                                  <!--<span class="text-truncate me-0"><i class="far fa-money-bill-alt text-primary me-2"></i>{{job.sector}}</span>-->
                                  <span class="text-truncate me-3"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#29569F" class="bi bi-geo-alt-fill" viewBox="0 0 16 16">
                                      <path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/>
                                    </svg> {{job.location}}</span>
                                  <span class="text-truncate me-3"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#29569F" class="bi bi-clock-fill" viewBox="0 0 16 16">
                                      <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z"/>
                                    </svg> {{job.contract}}</span>                                
                              </div>
                          </div>
                          <div class="col-sm-12 col-md-4 d-flex flex-column align-items-start align-items-md-end justify-content-center">
                              <div class="d-flex mb-3">
                                  <a class="btn" style="background-color:#29569F; color:#FFFFFF" href="{% url 'job_detail' job.id %}">Apply Now</a>
                              </div>
                                  <small class="text-truncate"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#29569F" class="bi bi-calendar3" viewBox="0 0 16 16">
                                      <path d="M14 0H2a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zM1 3.857C1 3.384 1.448 3 2 3h12c.552 0 1 .384 1 .857v10.286c0 .473-.448.857-1 .857H2c-.552 0-1-.384-1-.857V3.857z"/>
                                      <path d="M6.5 7a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm-9 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm-9 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
                                    </svg> Application ends: {{job.expiration_date}}</small>
                          </div>  
                      </div>
                  </div>
                  {% empty%}
                 
                  <p>No jobs found.</p>
                  {% endfor%}
                  <nav aria-label="Page navigation example" class="offset-5 mb-5 mt-5">
                    <ul class="pagination">
                        {% if jobs.has_previous %}
                            <li class="page-item"><a class="page-link" href="?page={{ jobs.previous_page_number }}" style="background-color:#29569F; color:#FFFFFF">Previous</a></li>
                        {% endif %}
                        {% for num_page in  jobs.paginator.page_range %}
                        {% if jobs.number == num_page %}
                            <li class="page-item active"><a class="page-link" href="?page={{ num_page }}" style="background-color:#29569F; color:#FFFFFF">{{num_page}}</a></li>
                        {% else %}
                            <li class="page-item"><a class="page-link" href="?page={{ num_page }}" style="background-color:#29569F; color:#FFFFFF">{{num_page}}</a></li>
                        {% endif %}
                        {% endfor %}
                        {% if jobs.has_next %}
                            <li class="page-item"><a class="page-link" href="?page={{ jobs.next_page_number }}" style="background-color:#29569F; color:#FFFFFF">Next</a></li>
                        {% endif %}
                    </ul>
                </nav>
                  {% endif %}

                  
      </div>
    </div>
  </div>
</div>


{% endblock content %}





